<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Tirage au sort</title>
<style>
div.naviguableStates {
height: 50%;
width: 50%;
margin-left : 35%; 
margin-top : 20%;
}

div.stateTitle {
margin-left : 30%; 
margin-top : 2%;
}

div.stateContent {
margin-left : 25%; 
margin-top : 5%;
}

div.list {
margin-left : 18%; 
margin-top : 10%;
}

div#notifications {
margin-left : 10%; 
margin-top : 10%;
}

/*
div#resultsDiv {
margin-left : 10%; 
margin-top : 10%;
}
*/
</style>
</head>
<body>
	<div id="notifications"></div>
	<div id="elementsAddingDiv" class="naviguableStates">
		<div class="stateTitle">Ajout de nouveaux éléments :</div>
		<div class="stateContent">
			<input type="text" id="typingField"></input>
			<button onclick="addElement()">Ajouter</button>
			<button onclick="clearList()">Vider Liste</button>
		</div>
		<div class="contentList list">
		</div>
	</div>
	<div id="settingUpDiv" class="naviguableStates">
		<div class="stateTitle">Précision éléments de configuration du tirage :</div>
		<div class="stateContent">Combien d'éléments doivent être tirés au sort ? 
			<div>	
				<input type="number"id="numberOfElements"></input><button onclick="drawAndRender()">Procéder au tirage au sort</button>
			</div>
		</div>
		<div class="contentList list">
		</div>
	</div>
	<div id="resultsDiv" class="naviguableStates">
		<div class="stateTitle">Résultat du tirage :</div>
		<div id="resultsContentDiv" class="list">
			
		</div>
	</div>
</body>
<script src="https://cdn.jsdelivr.net/npm/underscore@1.12.0/underscore-min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script type="text/javascript" language="javascript">
//var captain = 0;
var listToWorkOn = [];
var drawnNumbers = [];
var typingField = window.document.getElementById("typingField");
var pickedElementsNumber = window.document.getElementById("numberOfElements");
var listDisplayingAreas = window.document.getElementsByClassName("contentList");
var resultDisplayingArea = window.document.getElementById("resultsContentDiv");

function addElement() {
	if(_.isString(typingField.value) && !_.isEmpty(typingField.value.trim())) {
		listToWorkOn.push(typingField.value.trim());
		renderListContent();
	}
}

function clearList() {
	listToWorkOn.length = 0;
	renderListContent();
}

function renderListContent(){
	var result = '';
	for(loopElmtId in listToWorkOn) {
		result = result + '<div>' + listToWorkOn[loopElmtId] +  '</div>';
	}
	for(loopElmtId1 in listDisplayingAreas) {
		listDisplayingAreas[loopElmtId1].innerHTML = result;
	}
}

function drawAndRender(){
	if(isNumber(pickedElementsNumber.value) && pickedElementsNumber.value < listToWorkOn.length) {
		draw();
		renderResult();
	}
}

function draw() {
	var numberOfDraws = pickedElementsNumber.value;
	drawnNumbers.length = 0;
	for(var i = 0;i<numberOfDraws;) {
		var tmpDrawn = Math.floor(Math.random() * listToWorkOn.length);
		if (!drawnNumbers.includes(tmpDrawn)){
			drawnNumbers.push(tmpDrawn);
			++i;
		}
	}
}

function renderResult(){
	var result = '';
	for(loopElmtId in drawnNumbers){
		result = result + '<div>' + listToWorkOn[drawnNumbers[loopElmtId]] +  '</div>';
	}
	resultDisplayingArea.innerHTML = result;
}

function isNumber(paramVar) {
	var result = false;
	if(!_.isEmpty(paramVar)){
		result = paramVar.match(/[1-9]+0*/g).length > 0;
	}
	return result;
}

/*
function isAddingElementsState(){
	return captain === 0;
}

function isSettingUpState(){
	return captain === 1;
}

function isReviewingState(){
	return captain === 2;
}
*/
</script>
</html>
